# –ú–æ–¥—É–ª—å 4. –£—Ä–æ–∫ 21. –¢–∏–ø—ã —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ –≤ Django: ForeignKey, ManyToManyField, OneToOneField

## üé¨ –í–≤–µ–¥–µ–Ω–∏–µ: –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏?

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Å–æ–∑–¥–∞—ë–º –ø—Ä–æ–µ–∫—Ç **Cinemahub** ‚Äî —Å–∞–π—Ç –æ —Ñ–∏–ª—å–º–∞—Ö –∏ —Å–µ—Ä–∏–∞–ª–∞—Ö.

–£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å —Ñ–∏–ª—å–º–∞–º–∏, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏–µ, –≥–æ–¥ –≤—ã–ø—É—Å–∫–∞ –∏ —Ä–µ–π—Ç–∏–Ω–≥. –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–º–Ω–æ–≥–æ.

–ù–æ —á—Ç–æ –µ—Å–ª–∏ –º—ã –∑–∞—Ö–æ—Ç–∏–º –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ **–∂–∞–Ω—Ä–∞—Ö**, **–∞–∫—Ç—ë—Ä–∞—Ö**, **—Ä–µ–∂–∏—Å—Å—ë—Ä–∞—Ö**, **—Å—Ç—Ä–∞–Ω–∞—Ö**, **–∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö (—Ñ–∏–ª—å–º—ã / —Å–µ—Ä–∏–∞–ª—ã)** –∏ —Ç. –¥.?

–ù–∞–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É `Movie`. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª—è:

```text
genre = "–¥—Ä–∞–º–∞, —Ç—Ä–∏–ª–ª–µ—Ä"
actors = "–ö–∏–∞–Ω—É –†–∏–≤–∑, –õ–æ—É—Ä–µ–Ω—Å –§–∏—à–±—ë—Ä–Ω"
country = "–°–®–ê"
```

–ü–æ–Ω–∞—á–∞–ª—É —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —É–¥–æ–±–Ω—ã–º, –Ω–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –º—ã —Å—Ç–æ–ª–∫–Ω—ë–º—Å—è —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏:

- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –∏–º–µ–Ω–∞ –∞–∫—Ç—ë—Ä–æ–≤, –∂–∞–Ω—Ä—ã –∏ —Å—Ç—Ä–∞–Ω—ã –±—É–¥—É—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è.
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –µ—Å–ª–∏ –∞–∫—Ç—ë—Ä —Å–º–µ–Ω–∏–ª –∏–º—è, –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å –µ–≥–æ –≤–æ –≤—Å–µ—Ö —Ñ–∏–ª—å–º–∞—Ö.
- **–ü–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º –≤—Å–µ–≥–¥–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –ø–æ —á–∏—Å–ª–æ–≤—ã–º –∫–ª—é—á–∞–º.

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏** ‚Äî —Å–ø–æ—Å–æ–± —Ä–∞–∑–ª–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º –∏ —Å–≤—è–∑–∞—Ç—å –∏—Ö –ª–æ–≥–∏—á–µ—Å–∫–∏.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö**.

---

### –ó–∞—á–µ–º –Ω–∞–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è?

- —É–º–µ–Ω—å—à–∞–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö;
- —É–ø—Ä–æ—â–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è—é—Ç –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏);
- —É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é.

---

## –¢–∏–ø—ã —Å–≤—è–∑–µ–π –≤ Django ORM

Django –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏:

| –¢–∏–ø —Å–≤—è–∑–∏        | Django-–ø–æ–ª–µ       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                          |
| ---------------- | ----------------- | --------------------------------------------------------------------------------- |
| –ú–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É  | `ForeignKey`      | –û–¥–∏–Ω –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –º–Ω–æ–≥–∏–º –¥—Ä—É–≥–∏–º (–ø—Ä–∏–º–µ—Ä: —Ñ–∏–ª—å–º ‚Üí –∫–∞—Ç–µ–≥–æ—Ä–∏—è).         |
| –ú–Ω–æ–≥–∏–µ –∫–æ –º–Ω–æ–≥–∏–º | `ManyToManyField` | –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π (–ø—Ä–∏–º–µ—Ä: –∞–∫—Ç—ë—Ä ‚Üî —Ñ–∏–ª—å–º).                 |
| –û–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É    | `OneToOneField`   | –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–≤—è–∑–∞–Ω–∞ —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–æ–π –¥—Ä—É–≥–æ–π (–ø—Ä–∏–º–µ—Ä: —Ñ–∏–ª—å–º ‚Üî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞). |

---

## ForeignKey ‚Äî —Å–≤—è–∑—å ¬´–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É¬ª

–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö —Ç–∏–ø–æ–≤ —Å–≤—è–∑–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω **–∂–∞–Ω—Ä** –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å **–º–Ω–æ–≥–æ —Ñ–∏–ª—å–º–æ–≤**,
–Ω–æ –∫–∞–∂–¥—ã–π —Ñ–∏–ª—å–º –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç **—Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –∂–∞–Ω—Ä—É**.

–°–æ–∑–¥–∞–¥–∏–º –¥–≤–µ –º–æ–¥–µ–ª–∏: `Genre` –∏ `Movie`.

```python
# movies/models.py

from django.db import models

class Genre(models.Model):
    name = models.CharField(max_length=100, unique=True)
    slug = models.SlugField(unique=True)

    def __str__(self):
        return self.name


class Movie(models.Model):
    title = models.CharField(max_length=200)
    year = models.PositiveIntegerField()
    description = models.TextField()
    genre = models.ForeignKey(Genre, on_delete=models.CASCADE)

    def __str__(self):
        return self.title
```

–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

- –ö–∞–∂–¥–æ–º—É —Ñ–∏–ª—å–º—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **–æ–¥–∏–Ω –∂–∞–Ω—Ä**.
- –ü–æ–ª–µ `genre` ‚Äî —ç—Ç–æ **–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á** (`ForeignKey`) –Ω–∞ —Ç–∞–±–ª–∏—Ü—É `Genre`.
- –ê—Ä–≥—É–º–µ–Ω—Ç `on_delete=models.CASCADE` –æ–∑–Ω–∞—á–∞–µ—Ç: –µ—Å–ª–∏ –∂–∞–Ω—Ä —É–¥–∞–ª–∏—Ç—å, —Ç–æ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å–º—ã —Ç–æ–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.

> üí° –≠—Ç–æ –ª–æ–≥–∏—á–Ω–æ: –µ—Å–ª–∏ –º—ã —É–¥–∞–ª—è–µ–º –∂–∞–Ω—Ä ¬´–î—Ä–∞–º–∞¬ª, —Ñ–∏–ª—å–º—ã, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è —Ç–æ–ª—å–∫–æ –∫ –Ω–µ–º—É, —Ç–æ–∂–µ –∏—Å—á–µ–∑–∞—é—Ç.

---

### –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

1. –°–¥–µ–ª–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

   ```bash
   python manage.py makemigrations
   python manage.py migrate
   ```

2. –û—Ç–∫—Ä–æ–π—Ç–µ Django Admin.
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∂–∞–Ω—Ä–æ–≤: ¬´–î—Ä–∞–º–∞¬ª, ¬´–ö–æ–º–µ–¥–∏—è¬ª, ¬´–ë–æ–µ–≤–∏–∫¬ª.
4. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å–º—ã –∏ —É–∫–∞–∂–∏—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∂–∞–Ω—Ä.

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤ –≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å–º–∞ –µ—Å—Ç—å —Å–≤–æ–π –∂–∞–Ω—Ä, –∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞ ‚Äî —Ñ–∏–ª—å–º—ã —Ç–∞–∫–∂–µ —É–¥–∞–ª—è—é—Ç—Å—è (–µ—Å–ª–∏ `CASCADE`).

---

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏

1. **–û—à–∏–±–∫–∞ `IntegrityError: NOT NULL constraint failed`**
   ‚Äî –í–æ–∑–Ω–∏–∫–∞–µ—Ç, –µ—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∏–ª—å–º–∞ –≤—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ –∂–∞–Ω—Ä, –∞ –ø–æ–ª–µ `genre` –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç `null`.

   **–†–µ—à–µ–Ω–∏–µ**: –¥–æ–±–∞–≤–∏—Ç—å `null=True` –∏ `blank=True`, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –∂–∞–Ω—Ä –±—ã–ª –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º:

   ```python
   genre = models.ForeignKey(Genre, on_delete=models.SET_NULL, null=True, blank=True)
   ```

2. **–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞**
   ‚Äî –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —Ñ–∏–ª—å–º—ã –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å, –∞ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –±–µ–∑ –∂–∞–Ω—Ä–∞:

   ```python
   on_delete=models.SET_NULL
   ```

---

## ManyToManyField ‚Äî —Å–≤—è–∑—å ¬´–º–Ω–æ–≥–∏–µ –∫–æ –º–Ω–æ–≥–∏–º¬ª

–¢–µ–ø–µ—Ä—å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º —Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–∫—Ç—ë—Ä–∞—Ö.

–û–¥–∏–Ω —Ñ–∏–ª—å–º –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç—ë—Ä–æ–≤**, –∞ –æ–¥–∏–Ω –∞–∫—Ç—ë—Ä –º–æ–∂–µ—Ç —Å–Ω–∏–º–∞—Ç—å—Å—è **–≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∏–ª—å–º–∞—Ö**.

–î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–¥–∏–º –º–æ–¥–µ–ª–∏ `Actor` –∏ `Movie`.

```python
class Actor(models.Model):
    name = models.CharField(max_length=100)
    birth_year = models.PositiveIntegerField(null=True, blank=True)

    def __str__(self):
        return self.name


class Movie(models.Model):
    title = models.CharField(max_length=200)
    year = models.PositiveIntegerField()
    description = models.TextField()
    genre = models.ForeignKey(Genre, on_delete=models.SET_NULL, null=True)
    actors = models.ManyToManyField(Actor)

    def __str__(self):
        return self.title
```

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç Django:

- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `movie_actors`, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–∞—Ä—ã `movie_id` ‚Üî `actor_id`;
- –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–∏—Å–∞—Ç—å SQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã;
- –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å, —É–¥–∞–ª—è—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∏.

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç—ë—Ä–æ–≤.
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —Ñ–∏–ª—å–º ‚Äî –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç—ë—Ä–æ–≤.
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–≤—è–∑—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã:

   - —É –∞–∫—Ç—ë—Ä–∞ –≤–∏–¥–Ω—ã –≤—Å–µ —Ñ–∏–ª—å–º—ã,
   - —É —Ñ–∏–ª—å–º–∞ ‚Äî –≤—Å–µ –∞–∫—Ç—ë—Ä—ã.

---

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏

- **–û—à–∏–±–∫–∞: `ValueError: Cannot assign "..."`**
  ‚Äî –í–æ–∑–Ω–∏–∫–∞–µ—Ç, –µ—Å–ª–∏ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –ø—Ä–∏—Å–≤–æ–∏—Ç—å –æ–±—ä–µ–∫—Ç –Ω–∞–ø—Ä—è–º—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `movie.actors = actor`) –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ `.add()` –∏–ª–∏ `.set()`.

  ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:

  ```python
  movie.actors.add(actor)
  ```

---

## OneToOneField ‚Äî —Å–≤—è–∑—å ¬´–æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É¬ª

–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ **—Ä–æ–≤–Ω–æ –æ–¥–Ω–∞** —Å–≤—è–∑–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å.

–ù–∞–ø—Ä–∏–º–µ—Ä, —É —Ñ–∏–ª—å–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å **–æ–¥–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞**, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é ‚Äî –±—é–¥–∂–µ—Ç, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ä–µ–∂–∏—Å—Å—ë—Ä–∞ –∏ —Ç. –¥.

```python
class MovieDetail(models.Model):
    movie = models.OneToOneField(Movie, on_delete=models.CASCADE)
    director = models.CharField(max_length=100)
    duration = models.PositiveIntegerField(help_text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–Ω—É—Ç–∞—Ö")
    budget = models.PositiveIntegerField(null=True, blank=True)

    def __str__(self):
        return f"–î–µ—Ç–∞–ª–∏ —Ñ–∏–ª—å–º–∞: {self.movie.title}"
```

- `OneToOneField` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ `Movie` –º–æ–∂–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å `MovieDetail`.
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∏–ª—å–º–∞ –µ–≥–æ –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞.

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã OneToOneField

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∏–ª—å–º.
2. –í –∞–¥–º–∏–Ω–∫–µ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å—å `MovieDetail` –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∏–ª—å–º.
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –µ—â—ë –æ–¥–Ω—É –∑–∞–ø–∏—Å—å `MovieDetail` —Å —Ç–µ–º –∂–µ —Ñ–∏–ª—å–º–æ–º ‚Äî Django –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ —Å–≤—è–∑—å —Å—Ç—Ä–æ–≥–æ ¬´–æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É¬ª.

---

## –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π

| –¢–∏–ø —Å–≤—è–∑–∏      | –ü—Ä–∏–º–µ—Ä                | –ü–æ–≤–µ–¥–µ–Ω–∏–µ                                              |
| -------------- | --------------------- | ------------------------------------------------------ |
| **ForeignKey** | `Movie ‚Üí Genre`       | –û–¥–∏–Ω –∂–∞–Ω—Ä ‚Äî –º–Ω–æ–≥–æ —Ñ–∏–ª—å–º–æ–≤                              |
| **ManyToMany** | `Movie ‚Üî Actor`       | –û–¥–∏–Ω —Ñ–∏–ª—å–º ‚Äî –º–Ω–æ–≥–æ –∞–∫—Ç—ë—Ä–æ–≤, –æ–¥–∏–Ω –∞–∫—Ç—ë—Ä ‚Äî –º–Ω–æ–≥–æ —Ñ–∏–ª—å–º–æ–≤ |
| **OneToOne**   | `Movie ‚Üí MovieDetail` | –û–¥–∏–Ω —Ñ–∏–ª—å–º ‚Äî –æ–¥–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å                     |

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ `movies`:

1. **Genre** ‚Äì –∂–∞–Ω—Ä—ã —Ñ–∏–ª—å–º–æ–≤ (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Å–ª–∞–≥).
2. **Actor** ‚Äì –∞–∫—Ç—ë—Ä—ã (–∏–º—è, –≥–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è).
3. **Movie** ‚Äì —Ñ–∏–ª—å–º—ã (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≥–æ–¥, —Ä–µ–π—Ç–∏–Ω–≥, –∂–∞–Ω—Ä, –∞–∫—Ç—ë—Ä—ã).
4. **MovieDetail** ‚Äì –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ä–µ–∂–∏—Å—Å—ë—Ä, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –±—é–¥–∂–µ—Ç, —Å–≤—è–∑—å 1:1 —Å —Ñ–∏–ª—å–º–æ–º).

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

- –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞ —É–¥–∞–ª—è—é—Ç—Å—è –∏–ª–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å–º—ã (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `on_delete`);
- –æ–¥–∏–Ω –∞–∫—Ç—ë—Ä –º–æ–∂–µ—Ç —Å–Ω–∏–º–∞—Ç—å—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∏–ª—å–º–∞—Ö;
- –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ `MovieDetail` –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞.

---

## –í–æ–ø—Ä–æ—Å—ã

1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏?
2. –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `ForeignKey`, `ManyToManyField` –∏ `OneToOneField`?
3. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `on_delete=models.CASCADE`?
4. –ö–∞–∫ Django —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è `ManyToManyField` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö?
5. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –∂–∞–Ω—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞—é—Ç—Å—è —Ñ–∏–ª—å–º—ã –ø—Ä–∏ `on_delete=models.SET_NULL`?
6. –ú–æ–∂–Ω–æ –ª–∏ –≤ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `ForeignKey` –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ç–∞–±–ª–∏—Ü—É?
7. –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç—ë—Ä–∞ –∫ —Ñ–∏–ª—å–º—É —á–µ—Ä–µ–∑ Python-–∫–æ–Ω—Å–æ–ª—å?
8. –ü–æ—á–µ–º—É `OneToOneField` –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π `ForeignKey`?
9. –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å –¥–≤–µ `MovieDetail` –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞?
10. –ö–∞–∫ –≤ –∞–¥–º–∏–Ω–∫–µ Django –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—è `ManyToManyField`?

---

[–ü—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–∫](lesson20.md) | [–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫](lesson22.md)
